(()=>{"use strict";const e=e=>{Array.from(document.querySelectorAll(".btn")).map((t=>{e&&"K"===t.id[0]&&"e"===t.id[1]?t.textContent=t.innerHTML.toUpperCase():e||"K"!==t.id[0]||"e"!==t.id[1]||(t.textContent=t.innerHTML.toLowerCase())}))},t=async(e,t)=>{let n=await a();(e?"EN"===t?n.keyboardUpper:n.keyboardRuUpper:"RU"===t?n.keyboardRu:n.keyboard).map((e=>{e.keys.map((e=>{document.getElementById(e.id).textContent=e.key}))}))},a=async()=>{let e=await fetch("./keyboard.json");return await e.json()},n=async e=>{let t=document.createElement("div");t.className="keyboard";let n=await a();return("EN"===e?n.keyboard:n.keyboardRu).map((e=>{t.append((e=>{let t=document.createElement("div");return t.className="row",e.map((e=>{let a=document.createElement("span");a.className="btn",a.id=e.id;let n=e.id;a.classList.add(n),a.textContent=e.key,t.append(a)})),t})(e.keys))})),t};let i=!1,l="EN",d=!1,o=[];window.onload=function(){let e=localStorage.getItem("lang");e&&(l=e)},window.onload(),document.querySelector("html").setAttribute("lang","en"),async function(){let e=document.createElement("div");e.className="container",e.append(function(){let e=document.createElement("h1");return e.className="title",e.textContent="Виртуальная клавиатура",e}()),e.append((()=>{let e=document.createElement("textarea");return e.className="textarea",e.setAttribute("rows","50"),e.setAttribute("cols","50"),e})());let t=await n(l);e.append(t);let a=document.createElement("p"),i=document.createElement("p");a.className="discription",i.className="language",a.textContent="Клавиатура создана в операционной системе Windows",i.textContent="Для переключения языка комбинация: левыe Shift + Alt",e.append(a),e.append(i),document.body.append(e),o=Array.from(document.querySelectorAll(".btn"))}(),document.addEventListener("keydown",(function(a){a.detail.code&&(a.code=a.detail.code),a.detail.key&&(a.key=a.detail.key);const n=document.querySelector(".textarea");let o=Array.from(document.querySelectorAll(".btn")).find((e=>e.id===a.code));if(o&&"K"===o.id[0]&&"e"===o.id[1]||"D"===o.id[0]&&"i"===o.id[1]||"Backquote"===o.id||"Minus"===o.id||"Equal"===o.id||"BracketLeft"===o.id||"BracketRight"===o.id||"Backslash"===o.id||"Semicolon"===o.id||"Quote"===o.id||"Comma"===o.id||"Period"===o.id||"Slash"===o.id){a.preventDefault();let e=n.selectionStart;e===n.value.length?n.value+=o.textContent:0===e?(n.value=o.textContent+n.value,n.setSelectionRange(e+1,e+1)):e>0&&e<n.value.length&&(n.value=n.value.slice(0,e)+o.textContent+n.value.slice(e,n.length),n.setSelectionRange(e+1,e+1))}"CapsLock"===o.id?i?(i=!1,o.classList.remove("active"),e(i)):(i=!0,o.classList.add("active"),e(i)):o.classList.add("active"),"ShiftLeft"!==o.id&&"ShiftRight"!==o.id||(o.classList.add("active"),t(!i,l),d=!0),d&&"AltLeft"===o.id&&(l="EN"===l?"RU":"EN")})),document.addEventListener("keyup",(e=>{let a=Array.from(document.querySelectorAll(".btn")).find((t=>t.id===e.code));"ShiftLeft"!==a.id&&"ShiftRight"!==a.id||(a.classList.remove("active"),t(!!i,l),d=!1),"CapsLock"!==a.id&&a.classList.remove("active")})),setTimeout((()=>{document.querySelector(".textarea").addEventListener("click",(()=>{})),o.map((t=>{t.addEventListener("click",(()=>{let a=document.querySelector(".textarea");console.log(a),a.focus();let n=a.selectionStart;t&&"K"===t.id[0]&&"e"===t.id[1]||"D"===t.id[0]&&"i"===t.id[1]||"Backquote"===t.id||"Minus"===t.id||"Equal"===t.id||"BracketLeft"===t.id||"BracketRight"===t.id||"Backslash"===t.id||"Semicolon"===t.id||"Quote"===t.id||"Comma"===t.id||"Period"===t.id||"Slash"===t.id||"ArrowLeft"===t.id||"ArrowRight"===t.id||"ArrowUp"===t.id||"ArrowDown"===t.id?n===a.value.length?a.value+=t.textContent:0===n?(a.value=t.textContent+a.value,a.setSelectionRange(n+1,n+1)):n>0&&n<a.value.length&&(a.value=a.value.slice(0,n)+t.textContent+a.value.slice(n,a.length),a.setSelectionRange(n+1,n+1)):"Backspace"===t.id?n>0&&(a.value=a.value.slice(0,n-1)+a.value.slice(n,a.length),a.setSelectionRange(n-1,n-1)):"Delete"===t.id?(a.value=a.value.slice(0,n)+a.value.slice(n+1,a.length),a.setSelectionRange(n,n)):"Enter"===t.id?a.value+="\n":"CapsLock"===t.id?i?(i=!1,t.classList.remove("active"),e(i)):(i=!0,t.classList.add("active"),e(i)):"Space"===t.id&&n>0&&n<a.value.length&&(a.value=a.value.slice(0,n)+" "+a.value.slice(n,a.length),a.setSelectionRange(n+1,n+1))}))}))}),1e3),window.onbeforeunload=function(){localStorage.setItem("lang",l)},window.onbeforeunload()})();
//# sourceMappingURL=main.js.map